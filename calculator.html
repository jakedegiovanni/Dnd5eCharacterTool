<!Doctype html>
<html>
    <head>
         <meta charset="UTF-8">
        <title>Ability Calculator</title>

        <style>
            td {
                width: 50%;
                padding-top: 3%;
                padding-bottom: 3%;
                text-align: center;
            }

            select {
                margin-left: 3%;
                margin-top: 3%;
                margin-bottom: 1.5%;
            }
        </style>

        <script src="d3/d3.min.js" charset="utf-8"></script>
    </head>
    <body>
        <div align="center">
            <select id="race" onchange="populateTableRace()">
                <option value="norace">Please Select a Race</option>
                <option value="hilldwarf">Hill Dwarf</option>
                <option value="mountaindwarf">Mountain Dwarf</option>
                <option value="highelf">High-Elf</option>
                <option value="woodelf">Wood-Elf</option>
                <option value="darkelf">Dark-Elf/Drow</option>
                <option value="lightfoot">Lightfoot-Halfling</option>
                <option value="stout">Stout-Halfling</option>
                <option value="human">Human</option>
                <option value="dragonborn">Dragonborn</option>
                <option value="forestgnome">Forest-Gnome</option>
                <option value="rockgnome">Rock-Gnome</option>
                <option value="halfelf">Half-Elf</option>
                <option value="halforc">Half-Orc</option>
                <option value="tiefling">Tiefling</option>
            </select>

            <select>
                <option value="none">Please Select a Class</option>
                <option value="barbarian">Barbarian</option>
                <option value="bard">Bard</option>
                <option value="cleric">Cleric</option>
                <option value="druid">Druid</option>
                <option value="fighter">Fighter</option>
                <option value="monk">Monk</option>
                <option value="paladin">Paladin</option>
                <option value="ranger">Ranger</option>
                <option value="rogue">TRogue</option>
                <option value="sorcerer">Sorcerer</option>
                <option value="warlock">Warlock</option>
                <option value="wizard">Wizard</option>
            </select>
        </div>

        <div align=center><button type="button" onclick="resetRace(); resetClass()">Reset All</button></div>

        <div>
            <table style="float: left">
                <tr>
                    <th>Strength</th>
                    <td>
                        <input id="strength" name="screen" value="0">
                        <button type="button" onclick="add('strength')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Dexterity</th>
                    <td>
                        <input id="dexterity" name="screen" value="0">
                        <button type="button" onclick="add('dexterity')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Constitution</th>
                    <td>
                        <input id="constitution" name="screen" value="0">
                        <button type="button" onclick="add('constitution')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Intelligence</th>
                    <td>
                        <input id="intelligence" name="screen" value="0">
                        <button type="button" onclick="add('intelligence')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Wisdom</th>
                    <td>
                        <input id="wisdom" name="screen" value="0">
                        <button type="button" onclick="add('wisdom')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Charisma</th>
                    <td>
                        <input id="charisma" name="screen" value="0">
                        <button type="button" onclick="add('charisma')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Remaining</th>
                    <td>
                        <input id="remaining" name="screen" value="0" style="width: 100%">
                    </td>
                </tr>

                <tr>
                    <td colspan="2"><button type="button" onclick="resetRace()">Reset</button></td>
                </tr>
            </table>

            <table style="float: right; padding-right: 7%">
                <tr>
                    <th>Hit Points</th>
                    <td>
                        <input id="hitpoints" name="screen" value="0">
                        <button type="button" onclick="add('hitpoints')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Hit Die</th>
                    <td>
                        <input id="hitdie" name="screen" value="0">
                        <button type="button" onclick="add('hitdie')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Proficiencies</th>
                    <td>
                        <input id="proficiencies" name="screen" value="0">
                        <button type="button" onclick="add('proficiencies')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Class Abilities</th>
                    <td>
                        <input id="classabilities" name="screen" value="0">
                        <button type="button" onclick="add('classabilities')">+</button>
                    </td>
                </tr>

                <tr>
                    <th>Remaining</th>
                    <td>
                        <input id="remaining" name="screen" value="0" style="width: 100%">
                    </td>
                </tr>

                <tr>
                    <td colspan="2"><button type="button" onclick="resetClass()">Reset</button></td>
                </tr>
            </table>
        </div>

        <script language="javascript">
            function add(target) {
                var prev = document.getElementById(target).value;
                prev = parseInt(prev);

                if (parseInt(document.getElementById('remaining').value) > 0) {
                    document.getElementById(target).value = prev + 1;
                    document.getElementById('remaining').value = parseInt(document.getElementById('remaining').value) - 1;
                }
            }

            function minus(target) {
                var prev = document.getElementById(target).value;
                if (parseInt(prev) > 0)
                    document.getElementById(target).value = parseInt(prev) - 1;
            }

            function resetRace() {
                populateTableRace();
                /*document.getElementById('strength').value = 0;
                document.getElementById('dexterity').value = 0;
                document.getElementById('constitution').value = 0;
                document.getElementById('intelligence').value = 0;
                document.getElementById('wisdom').value = 0;
                document.getElementById('charisma').value = 0;*/
            }

            function populateTableRace() {
                var name = document.getElementById("race").value;
                var file = "races/" + name + ".csv";
                var dataset = " ";
                var array = [];

                d3.csv(file, function(data) {
                //  console.log(data[0]);
                  dataset = JSON.stringify(data[0]);
                  array = dataset.split(",");

                  var i;
                  for (i = 0; i<array.length; i++) {
                      array[i] = array[i].split(":");
                  }

                  document.getElementById('strength').value = parseInt(array[0][1][1]);
                  document.getElementById('dexterity').value = parseInt(array[1][1][1]);
                  document.getElementById('constitution').value = parseInt(array[2][1][1]);
                  document.getElementById('intelligence').value = parseInt(array[3][1][1]);
                  document.getElementById('wisdom').value = parseInt(array[4][1][1]);
                  document.getElementById('charisma').value = parseInt(array[5][1][1]);
                  document.getElementById('remaining').value = parseInt(array[6][1][1]);
                });
            }

            function resetClass() {
                document.getElementById('hitpoints').value = 0;
                document.getElementById('hitdie').value = 0;
                document.getElementById('proficiencies').value = 0;
                document.getElementById('classabilities').value = 0;
            }
        </script>
    </body>
</html>
